
# üìù –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ `book2ru` (CLI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –∫–Ω–∏–≥)

---

## üìò –û–ø–∏—Å–∞–Ω–∏–µ

–°–æ–∑–¥–∞–π CLI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `book2ru` –Ω–∞ Ruby 3.4.2 –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –∫–Ω–∏–≥ –∏ —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ —Å –ø–æ–º–æ—â—å—é LLM —á–µ—Ä–µ–∑ OpenRouter API.

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
- –ü—Ä–æ—Å—Ç–æ–π, –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–æ–≤ (–≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –∫–Ω–∏–≥) –∏–∑ stdin –≤ stdout
- –ú–∏–Ω–∏–º—É–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –≤–µ—Å—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ ‚Äî –≤ –æ–¥–Ω–æ–º Ruby-—Ñ–∞–π–ª–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–º–µ–Ω—ã –º–æ–¥–µ–ª–∏, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π LLM
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –±—É–¥—É—â–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Go –∏–ª–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

---

## üèóÔ∏è –û–±—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å
1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–∏—Ç–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏–∑ stdin (`UTF-8`, plain text).
2. –†–∞–∑–±–∏–≤–∞–µ—Ç –≤—Ö–æ–¥–Ω–æ–π —Ç–µ–∫—Å—Ç –Ω–∞ **–±–∞—Ç—á–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ –ø–æ 10 000 –±–∞–π—Ç**, –Ω–µ —Ä–∞–∑—Ä—ã–≤–∞—è —Å—Ç—Ä–æ–∫–∏.
3. –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ (–≤ —Ç.—á. —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã –∏ —Ç–∞–±—ã) **–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ LLM**, –∞ –ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ stdout.
4. –ö–∞–∂–¥–∞—è –Ω–µ–ø—É—Å—Ç–∞—è –ø–∞—á–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ LLM —Å –ø—Ä–æ–º–ø—Ç–æ–º "Translate this text to Russian:" (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥–µ).
5. –û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ stdout.
6. –í –∫–æ–Ω—Ü–µ (–∏–ª–∏ –Ω–∞—á–∞–ª–µ) –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

---

## üì• –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –§–æ—Ä–º–∞—Ç: `plain text`, UTF-8
- –ò—Å—Ç–æ—á–Ω–∏–∫: stdin
- –°—Ç—Ä–æ–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è "–ø—É—Å—Ç–æ–π", –µ—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã –∏/–∏–ª–∏ —Ç–∞–±—ã (`/^\s*$/`)

---

## üì§ –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥: stdout
- –ö–∞–∂–¥–∞—è –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ö–∞–∂–¥–∞—è –ø–µ—Ä–µ–≤–µ–¥—ë–Ω–Ω–∞—è –ø–∞—á–∫–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ –ø–æ–ª—É—á–µ–Ω–∏—è
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤ –Ω–∞—á–∞–ª–µ –∏–ª–∏ –∫–æ–Ω—Ü–µ: —Å—Ç—Ä–æ–∫–∞ `# Translated by book2ru v0.1.0 using model google/gemini-2.0-flash-001`

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### YAML-—Ñ–∞–π–ª `.book2ru.yml`

–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:

```yaml
model: google/gemini-2.0-flash-001
prompt: "Translate this text to Russian:"
metadata_footer: true
```

- `model`: –∏–º—è –º–æ–¥–µ–ª–∏ –¥–ª—è OpenRouter (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `prompt`: –ø—Ä–æ–º–ø—Ç, –¥–æ–±–∞–≤–ª—è–µ–º—ã–π –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –±–∞—Ç—á–µ–º (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `metadata_footer`: –µ—Å–ª–∏ true ‚Äî –¥–æ–±–∞–≤–ª—è—Ç—å —Å—Ç—Ä–æ–∫—É –æ –≤–µ—Ä—Å–∏–∏ –∏ –º–æ–¥–µ–ª–∏ –≤ –∫–æ–Ω–µ—Ü

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `OPENROUTER_KEY` ‚Äî API-–∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ OpenRouter (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

–ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω –∫–ª—é—á –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –∫–æ–Ω—Ñ–∏–≥ ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —Å –æ—à–∏–±–∫–æ–π.
–¢–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è `.env` —Ñ–∞–π–ª (—á–µ—Ä–µ–∑ [dotenv](https://github.com/bkeepers/dotenv), –µ—Å–ª–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è).

---

## üí¨ CLI-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞:

```sh
book2ru < input.txt > output-ru.txt
```

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏:

```sh
book2ru -h | --help                      # –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
book2ru --version                        # –ü–æ–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é –∏ –º–æ–¥–µ–ª—å
book2ru -o <key> | --openrouter_key     # –£–∫–∞–∑–∞—Ç—å –∫–ª—é—á –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
book2ru -m <model> | --model            # –£–∫–∞–∑–∞—Ç—å –º–æ–¥–µ–ª—å LLM
book2ru -r <rpm> | --rate-limits        # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
```

---

## üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **timeout** ‚Äî –ø–æ–≤—Ç–æ—Ä –¥–æ `N` —Ä–∞–∑ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `3`, –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥–µ)
- **–ø—Ä–æ—á–∏–µ –æ—à–∏–±–∫–∏** ‚Äî –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –∫–æ–¥–æ–º `1`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sleep` –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–∞–º–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ï—Å–ª–∏ –∑–∞–¥–∞–Ω `--rate-limits` ‚Äî –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è `sleep(60 / rpm)`

---

## üß† –ü–æ–≤–µ–¥–µ–Ω–∏–µ LLM
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OpenRouter API (`https://openrouter.ai`)
- –ó–∞–ø—Ä–æ—Å—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–º–µ–Ω—ã –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑:
    - CLI
    - YAML-–∫–æ–Ω—Ñ–∏–≥
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <OPENROUTER_KEY>`

---

## ü™µ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `Logger` –∏–ª–∏ `puts` –¥–ª—è –æ—à–∏–±–æ–∫
- –ü—Ä–∏–º–µ—Ä: `[ERROR] No API key provided. Set OPENROUTER_KEY.`

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `RSpec`
- –ú–∏–Ω–∏–º—É–º: –ø–æ–∫—Ä—ã—Ç—å
    - —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –±–∞—Ç—á–∏
    - –ø—Ä–æ–ø—É—Å–∫ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
    - –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å –æ—à–∏–±–∫–∞–º–∏
    - CLI-—Ñ–ª–∞–≥–∏
    - mock LLM-–∑–∞–ø—Ä–æ—Å–æ–≤

---

## üí° –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–¥—É

- –Ø–∑—ã–∫: Ruby 3.4.2
- –û–¥–∏–Ω —Ñ–∞–π–ª: `book2ru.rb` ‚Äî –≤–µ—Å—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥
- –ú–∏–Ω–∏–º—É–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ë–µ–∑ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ü—Ä–æ—Å—Ç–æ–π, —á–∏—Å—Ç—ã–π, —á–∏—Ç–∞–±–µ–ª—å–Ω—ã–π –∫–æ–¥
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–π –ª–æ–≥–∏–∫–µ

---

## üîú –ë—É–¥—É—â–µ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞—á–µ–∫ (–º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –∏–ª–∏ asyncio-—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç)
- –í–µ—Ä—Å–∏—è –Ω–∞ Go (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª–æ–≥–∏–∫–∏)
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–µ—Ä–µ–∑ —Ñ–∞–π–ª, –∞ –Ω–µ stdin/stdout

